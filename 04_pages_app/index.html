<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>4. Pages app - Django</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "4. Pages app";
        var mkdocs_page_input_path = "04_pages_app.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Django
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../00_por_que_django/">¿Por qué Django?</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../01_introduccion/">1. Introducción</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../02_configuracion_inicial/">2. Configuración Inicial</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../03_hello_world_app/">3. Hello World app</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="./">4. Pages app</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#41-objetivos">4.1 Objetivos</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#42-configuracion-inicial">4.2 Configuración inicial</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#43-plantillas-templates">4.3 Plantillas (Templates)</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#431-donde-colocar-el-directorio-de-plantillas">4.3.1 Dónde colocar el directorio de plantillas</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#44-vistas-basadas-en-clases-class-based-views">4.4 Vistas basadas en clases (Class-Based Views)</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#45-urls">4.5 URLs</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#46-anadir-una-pagina-acerca-de">4.6 Añadir una página "Acerca de..."</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#47-extendiendo-plantillas">4.7 Extendiendo Plantillas</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#48-tests">4.8 Tests</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#49-git-github-gitlab-y-bitbucket">4.9 Git, GitHub, GitLab y Bitbucket</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#410-local-vs-produccion">4.10 Local vs Producción</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#411-heroku">4.11 Heroku</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#411-ficheros-adicionales">4.11 Ficheros adicionales</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#412-despliegue">4.12 Despliegue</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#crear-una-nueva-aplicacion-de-heroku-desde-la-linea-de-comandos-con-heroku-create">Crear una nueva aplicación de Heroku, desde la línea de comandos con heroku create</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#anadir-un-hook-para-heroku-dentro-de-git">Añadir un “hook” para Heroku dentro de git</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#configurar-la-aplicacion-para-ignorar-los-archivos-estaticos">Configurar la aplicación para ignorar los archivos estáticos</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#iniciar-el-servidor-de-heroku-para-que-la-aplicacion-este-activa">Iniciar el servidor de Heroku para que la aplicación esté activa</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#visitar-la-aplicacion-en-la-url-proporcionada-por-heroku">Visitar la aplicación en la URL proporcionada por Heroku</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#413-errores-404">4.13 Errores 404</a>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../05_message_board_app/">5. Message Board app</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../06_blog_app/">6. Blog app</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../07_formularios/">7. Formularios</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../08_cuentas_de_usuarios/">8. Cuentas de Usuarios</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../09_modelo_de_usuario_personalizado/">9. Modelo de Usuario Personalizado</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../10_autenticacion_de_usuarios/">10. Autenticación de Usuarios</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../11_bootstrap/">11. Bootstrap</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../12_cambio_y_restauracion_de_contrasenas/">12. Cambio y Restauración de Contraseñas</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../13_email/">13. Email</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../14_newspaper_app/">14. Newspaper app</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../15_permisos_y_autorizacion/">15. Permisos y Autorización</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../16_comentarios/">16. Comentarios</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../17_docker/">17. Docker</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Django</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" alt="Docs"></a> &raquo;</li>
      <li>4. Pages app</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="4-pages-app">4 Pages app</h1>
<h2 id="41-objetivos">4.1 Objetivos</h2>
<ul>
<li>Desplegar la app <em>Pages</em> con una página <em>homepage</em> y una <em>about</em></li>
<li>Vistas basadas en clases y plantillas (templates)</li>
</ul>
<h2 id="42-configuracion-inicial">4.2 Configuración inicial</h2>
<ul>
<li>Crear un nuevo directorio para el código</li>
<li>Instalar Django en un nuevo entorno virtual</li>
<li>Crear un nuevo projecto Django</li>
<li>Crear una nueva app <code>pages</code></li>
<li>Actualizar <code>settings.py</code></li>
</ul>
<pre><code class="language-bash">$ cd ~/Desktop
$ mkdir pages
$ cd pages
$ pipenv install --python 3.10
$ pipenv install django
$ pipenv shell
(pages) $ django-admin startproject pages_project .
(pages) $ python manage.py startapp pages   # ó (pages) $ django-admin startapp pages
</code></pre>
<p>FICHERO: <code>pages_project/settings.py</code> </p>
<pre><code class="language-python">...
    INSTALLED_APPS = [
        'pages.apps.PagesConfig', # new
...
</code></pre>
<ul>
<li>Arrancar servidor</li>
</ul>
<pre><code class="language-bash">(pages) $ python manage.py runserver
</code></pre>
<h2 id="43-plantillas-templates">4.3 Plantillas (Templates)</h2>
<ul>
<li>Cada framework precisa generar de alguna manera ficheros HTML. En Django, la aproximación es usar plantillas (templates) de tal forma que los archivos HTML individuales puedan ser servidos por una vista a la  página web especificada por la ruta (URL).  </li>
</ul>
<p><center>Plantilla –&gt; Vista –&gt; Ruta</center></p>
<ul>
<li><strong>Ruta</strong> (URL).- Controla la ruta inicial</li>
<li><strong>Vista</strong> (View).- Contiene la lógica (el qué). En páginas relacionadas con BD es lo que hace la mayor parte del trabajo en cuanto a decidir qué datos estarán disponibles para la plantilla.</li>
<li><strong>Plantilla</strong> (Template).- Contiene el HTML.</li>
</ul>
<h3 id="431-donde-colocar-el-directorio-de-plantillas">4.3.1 Dónde colocar el directorio de plantillas</h3>
<ul>
<li><strong>Por defecto</strong>, Django mira dentro de cada <strong>app</strong> en busca de plantillas.</li>
<li>En la app <code>pages</code> se creará una estructura de directorios como la siguiente con la plantilla <code>home.html</code> colgando de ella:  </li>
</ul>
<pre><code class="language-text">    └── pages
        ├── templates
            ├── pages
                ├── home.html      
</code></pre>
<ul>
<li><strong>La otra aproximación</strong> es hacer un directorio de plantillas común a todas las apps. </li>
<li>Hay que cambiar <code>settings.py</code> para que busque, también en este directorio, las plantillas que se necesiten.</li>
</ul>
<pre><code class="language-bash">   (pages) $ mkdir templates
   (pages) $ touch templates/home.html
</code></pre>
<p>FICHERO: <code>pages_project/settings.py</code> </p>
<pre><code class="language-python">TEMPLATES = [
    {
        ...
        'DIRS': [str(BASE_DIR.joinpath('templates'))],
        ...
    },
]
</code></pre>
<blockquote>
<p><code>str(BASE_DIR.joinpath('templates'))</code> toma el directorio base y le abrega el directorio <code>templates</code> para finalmente construir una cadena con el <em>path</em> completo. También se podría utilizar la función <code>os.path.join</code> que une el <em>path</em> base de la aplicación (<code>BASE_DIR</code>) con el nuevo directorio <code>templates</code> añadiendo <code>/</code> según sea conveniente. Hemos de importar la librería <code>os</code> (<code>import os</code>) para hacer uso de esta segunda función.</p>
</blockquote>
<p>FICHERO: <code>templates/home.html</code> </p>
<pre><code class="language-html">   &lt;h1&gt;Homepage&lt;/h1&gt;
</code></pre>
<ul>
<li>Ahora es el turno de la <strong>ruta</strong> y la <strong>vista</strong></li>
</ul>
<h2 id="44-vistas-basadas-en-clases-class-based-views">4.4 Vistas basadas en clases (Class-Based Views)</h2>
<ul>
<li>Las primeras versiones de Django solo incluían vistas basadas en <strong>funciones</strong>, pero los desarrolladores pronto se encontraron repitiendo los mismos patrones una y otra vez.</li>
<li>Sin embargo, no había una manera fácil de ampliar o personalizar estas vistas.</li>
<li>Django introdujo vistas genéricas basadas en clases que facilitan el uso y también amplían las vistas que cubren casos de uso comunes.</li>
<li>En el ejemplo se usará la clase <code>TemplateView</code> incorporada para mostrar la plantilla.  </li>
</ul>
<p>FICHERO: <code>pages/views.py</code> </p>
<pre><code class="language-python">from django.views.generic import TemplateView


class HomePageView(TemplateView):
    template_name = 'home.html'
</code></pre>
<ul>
<li>Distíngase cómo se ha puesto en mayúsculas la vista, porque ahora es una clase, y cómo ésta es descendiente de la clase base <code>TemplateView</code>.</li>
</ul>
<h2 id="45-urls">4.5 URLs</h2>
<ul>
<li>El último paso es actualizar las <code>URLConfs</code>.</li>
</ul>
<p>FICHERO: <code>pages/urls.py</code> </p>
<pre><code class="language-python">from django.urls import path
from .views import HomePageView

urlpatterns = [
    path('', HomePageView.as_view(), name='home'),
]
</code></pre>
<p>FICHERO: <code>pages_project/urls.py</code> </p>
<pre><code class="language-python">from django.contrib import admin
from django.urls import path, include # new

urlpatterns = [
    path('admin/', admin.site.urls),
    path('', include('pages.urls')), # new
]
</code></pre>
<ul>
<li>Este patrón es casi idéntico al que se hizo anteriormente, con una sola diferencia; cuando se usan vistas basadas en clases, siempre se añade <code>as_view()</code> al final de su nombre.</li>
<li>Iniciar el servidor para ver la nueva página de inicio.</li>
</ul>
<h2 id="46-anadir-una-pagina-acerca-de">4.6 Añadir una página "Acerca de..."</h2>
<ul>
<li>Crear un nuevo fichero de plantilla</li>
</ul>
<pre><code class="language-bash">(pages) $ touch templates/about.html
</code></pre>
<p>FICHERO: <code>templates/about.html</code> </p>
<pre><code class="language-html">&lt;h1&gt;Acerca de...&lt;/h1&gt;
</code></pre>
<ul>
<li>Crear una nueva vista para la página</li>
</ul>
<p>FICHERO: <code>pages/views.py</code> </p>
<pre><code class="language-python">from django.views.generic import TemplateView


class HomePageView(TemplateView):
    template_name = 'home.html'


class AboutPageView(TemplateView):
    template_name = 'about.html'
</code></pre>
<ul>
<li>Conectar la vista con la ruta</li>
</ul>
<p>FICHERO: <code>pages/urls.py</code> </p>
<pre><code class="language-python">    from django.urls import path
    from .views import HomePageView, AboutPageView # new

    urlpatterns = [
        path('about/', AboutPageView.as_view(), name='about'), # new
        path('', HomePageView.as_view(), name='home'),
    ]
</code></pre>
<ul>
<li>Lanzar <code>http://localhost:8000/about</code></li>
</ul>
<h2 id="47-extendiendo-plantillas">4.7 Extendiendo Plantillas</h2>
<ul>
<li>El poder real de las plantillas es la posibilidad de ser extendidas.</li>
<li>En las mayoría de webs encontramos contenido que se repite en cada página:</li>
<li>Hagamos una página canónica que será heredada por las demás</li>
<li>Django tiene un <a href="https://docs.djangoproject.com/es/3.0/ref/templates/builtins/">lenguaje mínimo de plantillas</a> para añadirles enlaces y lógica básica</li>
<li>Los tags de las plantillas tienen la forma</li>
</ul>
<div align=center>
    <pre>
        {% cualquier_cosa %}
    </pre>
</div>

<ul>
<li>
<p>Para añadir <strong>enlaces</strong> a nuestro proyecto podemos usar la etiqueta de plantilla <code>url</code> incorporada que toma un patrón de URL como argumento.</p>
</li>
<li>
<p>El tag  <code>url</code> utiliza los nombres opcionales de URL para crear enlaces automáticos por nosotros.</p>
</li>
<li>
<p>Por ejemplo: <code>{% url 'home' %}</code></p>
</li>
</ul>
<p>FICHERO: <code>templates/base.html</code></p>
<pre><code class="language-html">&lt;header&gt;
  &lt;a href=&quot;{% url 'home' %}&quot;&gt;Home&lt;/a&gt; | 
  &lt;a href=&quot;{% url 'about' %}&quot;&gt;About&lt;/a&gt;
&lt;/header&gt;

{% block content %}
{% endblock content %}
</code></pre>
<ul>
<li>
<p>Al final se añade un tag <code>block</code> llamado <code>content</code>. Los bloques pueden ser reescritos por las vistas descencientes.</p>
</li>
<li>
<p>El lenguaje de plantillas de Django dispone de un método <code>extends</code> que puede usarse para actualizar <code>home.html</code> y <code>about.html</code> y así extender la plantilla <code>base.html</code>.</p>
</li>
</ul>
<p>FICHERO: <code>templates/home.html</code> </p>
<pre><code class="language-html">{% extends 'base.html' %}

{% block content %}
&lt;h1&gt;Homepage&lt;/h1&gt;
{% endblock content %}
</code></pre>
<p>FICHERO: <code>templates/about.html</code></p>
<pre><code class="language-html">{% extends 'base.html' %}

{% block content %}
    &lt;h1&gt;About page&lt;/h1&gt;
{% endblock content %}
</code></pre>
<h2 id="48-tests">4.8 Tests</h2>
<ul>
<li>
<p>Importancia de los tests </p>
</li>
<li>
<p><em>Jaco Kaplan-Moss</em>: "Code without tests is broken as designed." (El código sin pruebas se rompe según se diseñó)</p>
</li>
<li>
<p>Django nos brinda herramientas para escribir y correr tests.</p>
</li>
</ul>
<p>FICHERO: <code>pages/tests.py</code></p>
<pre><code class="language-python"># pages/tests.py
from django.test import SimpleTestCase

class SimpleTests(SimpleTestCase):
    def test_home_page_status_code(self):
        response = self.client.get('/')
        self.assertEqual(response.status_code, 200)

    def test_about_page_status_code(self):
        response = self.client.get('/about/')
        self.assertEqual(response.status_code, 200)
</code></pre>
<ul>
<li>Se usa <code>SimpleTestCase</code> ya que no estamos usando una base de datos. Si estuviéramos usando una base de datos, en su lugar usaríamos <code>TestCase</code>. </li>
<li>Luego se realiza una comprobación de si el código de estado para cada página es 200, que es la respuesta estándar para una solicitud HTTP exitosa.</li>
<li>Esa es una manera elegante de garantizar que una página web determinada realmente existe, pero no dice nada sobre su contenido.</li>
<li>Para ejecutar los tests:</li>
</ul>
<pre><code class="language-bash">(pages) $ python manage.py test
System check identified no issues (0 silenced).
..
---------------------------------------------------------------
Ran 2 tests in 0.014s

OK
</code></pre>
<h2 id="49-git-github-gitlab-y-bitbucket">4.9 Git, GitHub, GitLab y Bitbucket</h2>
<pre><code class="language-bash">(pages) $ git init
(pages) $ git status
(pages) $ git add -A
(pages) $ git commit -m 'Commit inicial'
</code></pre>
<h2 id="410-local-vs-produccion">4.10 Local vs Producción</h2>
<ul>
<li>Código en producción</li>
<li>Código implementado en un servidor externo para que cualquiera pueda ver el sitio web.</li>
<li>Hay muchos proveedores de servidores disponibles, pero usaremos <em>Heroku</em> porque es gratis para pequeños proyectos, ampliamente utilizado y tiene un proceso de implementación relativamente sencillo.</li>
</ul>
<h2 id="411-heroku">4.11 Heroku</h2>
<ul>
<li>Se puede obtener una cuenta gratuita de Heroku en <a href="https://www.heroku.com/">su sitio web</a>.</li>
<li>Ahora se necesita instalar la interfaz de línea de comando (CLI) de Heroku para poder implementar desde la línea de comando.</li>
<li>Queremos instalar Heroku globalmente para que esté disponible en toda nuestra computadora.</li>
<li>Si se instala Heroku dentro de un entorno virtual, solo estará disponible allí.</li>
<li><a href="https://devcenter.heroku.com/articles/heroku-cli">Instalar Heroku según el sitio web de Heroku</a></li>
<li><a href="https://devcenter.heroku.com/articles/heroku-cli#arch-linux">Arch Linux</a><ul>
<li><a href="https://aur.archlinux.org/packages/heroku-cli">Este paquete</a> está mantenido por la comunidad y no por Heroku.</li>
</ul>
</li>
</ul>
<pre><code class="language-bash">$ yay -S heroku-cli
</code></pre>
<pre><code class="language-bash">(pages) $ heroku login
Enter your Heroku credentials:
Email: will@wsvincent.com
Password: *********************************
Logged in as will@wsvincent.com
</code></pre>
<h2 id="411-ficheros-adicionales">4.11 Ficheros adicionales</h2>
<ul>
<li>
<p>Se necesitan hacer cuatro cambios al proyecto para desplegar en Heroku:</p>
</li>
<li>
<p>actualizar el archivo <code>Pipfile.lock</code></p>
</li>
<li>hacer un nuevo archivo <code>Procfile</code></li>
<li>instalar <code>gunicorn</code> como servidor web</li>
<li>
<p>hacer un cambio de una línea al archivo <code>settings.py</code></p>
</li>
<li>
<p>Especificar la versión de Python que se está usando en <code>Pipfile</code></p>
</li>
</ul>
<pre><code class="language-toml"># Pipfile
[requires]
python_version = &quot;3.9&quot;
</code></pre>
<p>Luego ejecutar <code>pipenv lock</code> para generar el archivo <code>Pipfile.lock</code> apropiado.</p>
<pre><code class="language-bash">(pages) $ pipenv lock
</code></pre>
<ul>
<li>Heroku busca en <code>Pipfile.lock</code> información sobre el entorno virtual.</li>
<li>A continuación crear un <code>Procfile</code> que es específico para Heroku.</li>
</ul>
<p>FICHERO: <code>Procfile</code></p>
<pre><code class="language-text">web: gunicorn pages_project.wsgi --log-file -
</code></pre>
<ul>
<li>Esto indica que se use el fichero <code>pages_project.wsgi</code> existente pero con <code>gunicorn</code>, que es un <em>servidor web adecuado para la producción</em>, en lugar del propio servidor de Django; que por otro lado aún tenemos que instalar.</li>
</ul>
<pre><code class="language-bash">(pages) $ pipenv install gunicorn
</code></pre>
<p>El último paso es un cambio de una línea a <code>settings.py</code>.</p>
<p>FICHERO: <code>pages_project/settings.py</code> </p>
<pre><code class="language-python"># pages_project/settings.py
ALLOWED_HOSTS = ['*']
</code></pre>
<ul>
<li>
<p>El parámetro <code>ALLOWEDHOSTS</code> representa los nombres de host/dominio que nuestro sitio Django puede servir. Esta es una medida de seguridad para evitar los ataques de cabecera de host HTTP, que son posibles incluso bajo muchas configuraciones de servidores web aparentemente seguras.</p>
</li>
<li>
<p>Sin embargo, se ha utilizado el comodín asterisco <code>*</code>, que significa que todos los dominios son aceptables para mantener las cosas simples.</p>
</li>
<li>
<p>En un sitio Django de nivel de producción, se enumeran explícitamente los dominios que están permitidos.</p>
</li>
<li>
<p>Usar <code>git status</code> para comprobar nuestros cambios, añadir los nuevos archivos, y luego confirmarlos:</p>
</li>
</ul>
<pre><code class="language-bash">(pages) $ git status
(pages) $ git add -A
(pages) $ git commit -m &quot;Actualiza para el despliegue en Heroku&quot;
(pages) $ git push -u origin master
</code></pre>
<h2 id="412-despliegue">4.12 Despliegue</h2>
<ul>
<li>Crear una nueva aplicación en Heroku y enviar el código</li>
<li>Añadir un "hook" remoto de git para Heroku</li>
<li>Configurar la aplicación para ignorar los archivos estáticos</li>
<li>Iniciar el servidor de Heroku para que la aplicación esté activa</li>
<li>Visitar la aplicación en la URL proporcionada por Heroku</li>
</ul>
<h3 id="crear-una-nueva-aplicacion-de-heroku-desde-la-linea-de-comandos-con-heroku-create">Crear una nueva aplicación de Heroku, desde la línea de comandos con heroku create</h3>
<pre><code class="language-bash">(pages) $ heroku create
Creating app... done, 
https://cryptic-oasis-40349.herokuapp.com/ | https://git.heroku.com/cryptic-oasis-40349.git
</code></pre>
<p>Sólo queda hacer un conjunto de configuraciones de Heroku, que son decirle a Heroku que
ignore los archivos estáticos como CSS y JavaScript que Django por defecto intenta optimizar por nosotros. </p>
<h3 id="anadir-un-hook-para-heroku-dentro-de-git">Añadir un “hook” para Heroku dentro de git</h3>
<ul>
<li>Git almacenará tanto la configuración para enviar el código a GitHub como a Heroku.</li>
</ul>
<pre><code class="language-bash">(pages) $ heroku git:remote -a cryptic-oasis-40349
</code></pre>
<h3 id="configurar-la-aplicacion-para-ignorar-los-archivos-estaticos">Configurar la aplicación para ignorar los archivos estáticos</h3>
<ul>
<li>Hay que decirle a Heroku que ignore los archivos estáticos como CSS y JavaScript que Django por defecto intenta optimizar para nosotros (se verá más adelante).</li>
<li>Por ahora sólo hay que ejecutar:</li>
</ul>
<pre><code>(pages) $ heroku config:set DISABLE_COLLECTSTATIC=1
</code></pre>
<ul>
<li>Ahora ya podemos enviar nuestro código a Heroku.</li>
</ul>
<pre><code>(pages) $ git push heroku master
</code></pre>
<h3 id="iniciar-el-servidor-de-heroku-para-que-la-aplicacion-este-activa">Iniciar el servidor de Heroku para que la aplicación esté activa</h3>
<ul>
<li>Se puede utilizar el nivel más bajo, <code>web=1</code>, que también resulta ser gratuito.</li>
</ul>
<pre><code>(pages) $ heroku ps:scale web=1
</code></pre>
<h3 id="visitar-la-aplicacion-en-la-url-proporcionada-por-heroku">Visitar la aplicación en la URL proporcionada por Heroku</h3>
<ul>
<li>Vistiar algo como https://cryptic-oasis-40349.herokuapp.com ó https://cryptic-oasis-40349.herokuapp.com/about/.</li>
<li>También puede utilizarse el comando 'heroku open' que abrirá el navegador con una pestaña a nuestra app.</li>
</ul>
<h2 id="413-errores-404">4.13 Errores 404</h2>
<ul>
<li>En las URLconf anteriores, se han definido varios patrones URL. ¿Qué pasaría si se solicita una URL diferente a las recogidas en URLconf?</li>
<li>Para averiguarlo, probar ejecutar el servidor de desarrollo Django e intentar acceder a una página Web como <code>http://127.0.0.1:8000/hello/</code> o <code>http://127.0.0.1:8000/does-not-exist/</code>. Se debería ver el mensaje <em>"Page not found"</em>. (Es linda, ¿no? A la gente de Django seguro le gustan los colores pasteles). Django muestra este mensaje porque se solicitó una URL que no está definida en URLconf.</li>
</ul>
<p><img alt="Captura de pantalla de la página 404 de Django." src="../img_pages_app/404.png" /></p>
<ul>
<li>La utilidad de esta página va más allá del mensaje básico de error 404; nos dice también, <strong>qué URLconf utilizó Django y todos los patrones de esa URLconf</strong>. Con esa información, tendríamos que ser capaces de establecer porqué la URL solicitada lanzó un error 404.</li>
<li>Naturalmente, esta es <strong>información importante sólo destinada al programador</strong>. Si esto fuera un sitio en producción alojado en Internet, no quisiéramos mostrar esta información al público. Por esta razón, la página <em>"Page not found"</em> sólo se muestra si el proyecto en Django está en modo de depuración (<em>debug mode</em>). Se explicará cómo desactivar este modo más adelante. Por ahora, todos los proyectos están en modo de depuración cuando se crean, y si el proyecto no lo estuviese, se retornaría una respuesta diferente.l</li>
</ul>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../03_hello_world_app/" class="btn btn-neutral float-left" title="3. Hello World app"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../05_message_board_app/" class="btn btn-neutral float-right" title="5. Message Board app">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../03_hello_world_app/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../05_message_board_app/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
